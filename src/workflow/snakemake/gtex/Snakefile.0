TISSUE_GENE_PAIRS = [ 'SDHB,Blood', 'SDHB,Brain' ]
GENES = set([p.split(',')[0] for p in TISSUE_GENE_PAIRS])
TISSUES = set([p.split(',')[1] for p in TISSUE_GENE_PAIRS])
OUTFILE='_'.join(TISSUE_GENE_PAIRS) + '.png'

rule all:
    input:
        {OUTFILE}

rule plot:
    input:
        expand("{gene}_counts.txt", gene=GENES),
        expand("{tissue}_samples.txt", tissue=TISSUES),
    output:
        {OUTFILE}
    shell:
        'python hist.py ' + ' '.join(TISSUE_GENE_PAIRS)


rule tissue_samples:
    input:
        "GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt"
    output:
        expand("{tissue}_samples.txt", tissue=TISSUES)
    shell:
        "for tissue in {TISSUES}; do python get_tissue_samples.py {input} $tissue; done"

rule sample_tissue_data:
    output:
        "GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt"
    shell:
        "wget https://storage.googleapis.com/gtex_analysis_v8/annotations/GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt"

rule gene_sample_counts:
    input:
        "GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.acmg_59.gct.gz"
    output:
        expand("{gene}_counts.txt", gene=GENES)
    shell:
        "for gene in {GENES}; do python get_gene_counts.py {input} $gene; done"
        
rule gene_data:
    output:
        "GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.acmg_59.gct.gz"
    shell:
        "wget https://github.com/swe4s/lectures/raw/master/data_integration/gtex/GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.acmg_59.gct.gz"
